import{c as v,a as e,o as u,d as ke,r as k,b as D,e as T,w as ie,f as h,g as A,u as a,v as z,h as $e,i as Y,F as H,j as R,n as b,k as xe,l as ee,t as c,m as N,p as q,q as Ve,s as be,x as qe,y as de,z as fe,A as Ue,B as ce,C as Me,D as De,E as we}from"./index-CTkTLTUi.js";import{u as ge,r as Be,a as Ae,b as he,c as Ce,d as Ie,e as Le,f as je}from"./PlusIcon-BRVSf6Yh.js";import{_ as Se,u as pe}from"./Modal.vue_vue_type_script_setup_true_lang-Tyj6Oo8g.js";import{u as Ee,_ as Pe,a as Fe}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-CcaFAIB0.js";function ze(te,L){return u(),v("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})])}const Te={class:"space-y-4"},Ne={class:"relative"},Ke={class:"flex items-center justify-between"},Qe={class:"flex items-center space-x-4"},Ze={class:"flex items-center"},Oe={class:"flex items-center"},He={class:"max-h-96 overflow-y-auto border border-gray-200 rounded-lg"},Re={key:0,class:"p-8 text-center"},We={key:1,class:"p-8 text-center text-gray-500"},Ge={key:2,class:"divide-y divide-gray-200"},Je={class:"flex items-center space-x-3"},Xe=["id","checked","onChange"],Ye={class:"flex-shrink-0"},et=["for"],tt={class:"text-sm font-medium text-gray-900"},st={class:"text-xs text-gray-500"},lt={key:0,class:"ml-2"},at={class:"flex items-center justify-between"},nt={class:"text-sm text-gray-500"},ot={class:"flex space-x-3"},rt=["disabled"],ut=ke({__name:"ItemSelector",emits:["close","select"],setup(te,{emit:L}){const f=L,x=k(""),U=k(!0),_=k(!0),y=k(new Set),{data:S,isLoading:F}=ge({queryKey:["inventory-for-bundle"],queryFn:()=>Ve.getInventoryRecords({pageSize:1e3})}),j=D(()=>{var d;const m=[];return(d=S.value)!=null&&d.data&&S.value.data.forEach(p=>{p.sellableItem&&m.push({id:p.sellableItem.id,sku:p.sellableItem.sku,type:p.sellableItem.type,available:p.available,onHand:p.onHand,reserved:p.reserved})}),m}),n=D(()=>{let m=j.value;if(m=m.filter(d=>!(d.type===0&&!U.value||d.type===1&&!_.value)),x.value){const d=x.value.toLowerCase();m=m.filter(p=>p.sku.toLowerCase().includes(d))}return m}),V=m=>{y.value.has(m.id)?y.value.delete(m.id):y.value.add(m.id)},E=()=>{const m=j.value.filter(d=>y.value.has(d.id));f("select",m)},w=()=>{n.value.forEach(m=>{y.value.add(m.id)})},W=()=>{y.value.clear()};return(m,d)=>(u(),T(Se,{"model-value":!0,title:"Select Items for Bundle",size:"lg","onUpdate:modelValue":d[4]||(d[4]=p=>!p&&m.$emit("close"))},{footer:ie(()=>[e("div",at,[e("div",nt,c(y.value.size)+" item"+c(y.value.size!==1?"s":"")+" selected ",1),e("div",ot,[e("button",{type:"button",onClick:d[3]||(d[3]=p=>m.$emit("close")),class:"btn btn-secondary"}," Cancel "),e("button",{type:"button",onClick:E,disabled:y.value.size===0,class:"btn btn-primary"}," Add "+c(y.value.size)+" Item"+c(y.value.size!==1?"s":""),9,rt)])])]),default:ie(()=>[e("div",Te,[e("div",Ne,[h(a(Be),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),A(e("input",{"onUpdate:modelValue":d[0]||(d[0]=p=>x.value=p),type:"text",placeholder:"Search products and variants...",class:"input pl-10 w-full"},null,512),[[z,x.value]])]),e("div",Ke,[e("div",Qe,[e("label",Ze,[A(e("input",{"onUpdate:modelValue":d[1]||(d[1]=p=>U.value=p),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[$e,U.value]]),d[5]||(d[5]=e("span",{class:"ml-2 text-sm text-gray-700"},"Show Product Variants",-1))]),e("label",Oe,[A(e("input",{"onUpdate:modelValue":d[2]||(d[2]=p=>_.value=p),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[$e,_.value]]),d[6]||(d[6]=e("span",{class:"ml-2 text-sm text-gray-700"},"Show Bundles",-1))])]),e("div",{class:"flex items-center space-x-2"},[e("button",{type:"button",onClick:w,class:"text-sm text-primary-600 hover:text-primary-800"}," Select All "),d[7]||(d[7]=e("span",{class:"text-gray-300"},"|",-1)),e("button",{type:"button",onClick:W,class:"text-sm text-gray-600 hover:text-gray-800"}," Clear All ")])]),e("div",He,[a(F)?(u(),v("div",Re,[...d[8]||(d[8]=[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-500 mx-auto"},null,-1),e("p",{class:"mt-2 text-sm text-gray-500"},"Loading items...",-1)])])):n.value.length?(u(),v("div",Ge,[(u(!0),v(H,null,R(n.value,p=>(u(),v("div",{key:p.id,class:b(["p-4 hover:bg-gray-50 transition-colors",{"bg-primary-50":y.value.has(p.id)}])},[e("div",Je,[e("input",{id:`item-${p.id}`,type:"checkbox",checked:y.value.has(p.id),onChange:se=>V(p),class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,40,Xe),e("div",Ye,[e("div",{class:b(["w-10 h-10 rounded-lg flex items-center justify-center",p.type===1?"bg-primary-100":"bg-gray-100"])},[(u(),T(xe(p.type===1?a(ee):a(Y)),{class:b(["w-5 h-5",p.type===1?"text-primary-600":"text-gray-500"])},null,8,["class"]))],2)]),e("label",{for:`item-${p.id}`,class:"flex-1 cursor-pointer"},[e("div",tt,c(p.sku),1),e("div",st,[N(c(p.type===1?"Bundle":"Product Variant")+" ",1),p.available!==void 0?(u(),v("span",lt," â€¢ "+c(p.available)+" available ",1)):q("",!0)])],8,et)])],2))),128))])):(u(),v("div",We,[h(a(Y),{class:"mx-auto h-12 w-12 text-gray-300 mb-2"}),d[9]||(d[9]=e("p",null,"No items found",-1)),d[10]||(d[10]=e("p",{class:"text-sm"},"Try adjusting your search or filters",-1))]))])])]),_:1}))}}),dt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},it={class:"space-y-6"},ct={key:0,class:"mt-1 text-sm text-red-600"},pt={key:0,class:"mt-1 text-sm text-red-600"},vt={class:"relative"},mt={key:0,class:"mt-1 text-sm text-red-600"},yt={key:0,class:"mt-1 text-sm text-red-600"},xt={key:0,class:"mt-1 text-sm text-red-600"},bt={class:"space-y-6"},ft={class:"flex items-center justify-between mb-4"},gt={class:"space-y-3 max-h-80 overflow-y-auto"},ht={class:"flex-1"},kt={class:"text-sm font-medium text-gray-900"},_t={class:"text-xs text-gray-500"},$t={class:"flex items-center space-x-2"},wt=["onUpdate:modelValue"],Ct=["onClick"],It={key:0,class:"text-center py-8 text-gray-500"},Bt={key:0,class:"mt-2 text-sm text-red-600"},At={class:"space-y-3"},St=["onUpdate:modelValue"],Vt=["onUpdate:modelValue"],qt=["onClick"],Ut=["disabled"],Mt=["disabled"],Dt={key:0,class:"flex items-center"},Lt={key:1},jt=ke({__name:"BundleForm",props:{bundle:{}},emits:["close","saved"],setup(te,{emit:L}){var ne,G,J,Z,oe,X,re;const f=te,x=L,U=Ae(),_=k(!1),y=k(!1),S=D(()=>!!f.bundle),F={name:((ne=f.bundle)==null?void 0:ne.name)||"",description:((G=f.bundle)==null?void 0:G.description)||"",sku:((J=f.bundle)==null?void 0:J.sku)||"",price:((Z=f.bundle)==null?void 0:Z.price)||0,status:((oe=f.bundle)==null?void 0:oe.status)??1,items:((X=f.bundle)==null?void 0:X.items)||[],metadata:((re=f.bundle)==null?void 0:re.metadata)||{}},j={name:{required:!0,minLength:2,maxLength:255},sku:{required:!0,minLength:2,maxLength:100,pattern:/^[A-Z0-9-_]+$/,custom:o=>o&&!/^[A-Z0-9-_]+$/.test(o)?"SKU can only contain uppercase letters, numbers, hyphens, and underscores":null},price:{required:!0,custom:o=>o<0?"Price must be greater than or equal to 0":null},description:{maxLength:2e3},status:{required:!0,custom:o=>o!==0&&o!==1&&o!==2?"Status must be Inactive (0), Active (1), or Archived (2)":null},items:{required:!0,custom:o=>!o||o.length===0?"At least one item is required":null}},{formData:n,validateForm:V,validateSingleField:E,isFormValid:w,formValues:W}=Ee(F,j),m=k([]),d=k([]),p=o=>{(Array.isArray(o)?o:[o]).forEach(r=>{const C=r.id,B=m.value.findIndex(O=>O.sellableItemId===C);B>=0?m.value[B].quantity+=1:m.value.push({sellableItemId:C,quantity:1,sellableItem:{id:C,sku:r.sku,type:r.type}})}),n.items.value=m.value.map(r=>({sellableItemId:r.sellableItemId,quantity:r.quantity})),y.value=!1},se=o=>{m.value.splice(o,1),n.items.value=m.value.map(t=>({sellableItemId:t.sellableItemId,quantity:t.quantity}))},ve=()=>{d.value.push({key:"",value:""})},P=o=>{d.value.splice(o,1)},Q=()=>{const o={};return d.value.forEach(t=>{t.key&&t.value&&(o[t.key]=t.value)}),o};be(()=>n.name.value,o=>{if(!S.value&&o){const t=o.toUpperCase().replace(/[^A-Z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim();n.sku.value=`${t}-BUNDLE`}});const le=pe({mutationFn:o=>ce.createBundle(o),onSuccess:o=>{U.invalidateQueries({queryKey:["bundles"]}),x("saved",o),x("close")},onError:o=>{var t,r;console.error("Create bundle error:",o),(r=(t=o.response)==null?void 0:t.data)!=null&&r.errors&&Object.entries(o.response.data.errors).forEach(([C,B])=>{n[C]&&(n[C].error=B[0])})}}),me=pe({mutationFn:({id:o,data:t})=>ce.updateBundle(o,t),onSuccess:o=>{U.invalidateQueries({queryKey:["bundles"]}),x("saved",o),x("close")},onError:o=>{var t,r;console.error("Update bundle error:",o),(r=(t=o.response)==null?void 0:t.data)!=null&&r.errors&&Object.entries(o.response.data.errors).forEach(([C,B])=>{n[C]&&(n[C].error=B[0])})}}),ae=async()=>{if(n.items.value=m.value.map(o=>({sellableItemId:o.sellableItemId,quantity:o.quantity})),!!V()){_.value=!0;try{const o={...W.value,items:m.value.map(t=>({sellableItemId:t.sellableItemId,quantity:t.quantity})),metadata:Q()};S.value&&f.bundle?await me.mutateAsync({id:f.bundle.id,data:o}):await le.mutateAsync(o)}finally{_.value=!1}}};return qe(()=>{var o;f.bundle&&(m.value=((o=f.bundle.items)==null?void 0:o.map(t=>({...t,sellableItem:t.sellableItem})))||[],f.bundle.metadata&&(d.value=Object.entries(f.bundle.metadata).map(([t,r])=>({key:t,value:String(r)}))))}),(o,t)=>(u(),T(Se,{"model-value":!0,title:S.value?"Edit Bundle":"Create Bundle",size:"xl","onUpdate:modelValue":t[13]||(t[13]=r=>!r&&o.$emit("close"))},{footer:ie(()=>[e("button",{type:"button",onClick:t[11]||(t[11]=r=>o.$emit("close")),class:"btn btn-secondary",disabled:_.value}," Cancel ",8,Ut),e("button",{onClick:ae,class:"btn btn-primary",disabled:_.value||!a(w)||!m.value.length},[_.value?(u(),v("div",Dt,[t[28]||(t[28]=e("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},null,-1)),N(" "+c(S.value?"Updating...":"Creating..."),1)])):(u(),v("span",Lt,c(S.value?"Update Bundle":"Create Bundle"),1))],8,Mt)]),default:ie(()=>[e("form",{onSubmit:Ue(ae,["prevent"]),class:"space-y-6"},[e("div",dt,[e("div",it,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Bundle Name * ",-1)),A(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>a(n).name.value=r),type:"text",class:b(["input",{"border-red-500":a(n).name.error&&a(n).name.touched}]),placeholder:"Enter bundle name",onBlur:t[1]||(t[1]=r=>a(E)("name"))},null,34),[[z,a(n).name.value]]),a(n).name.error&&a(n).name.touched?(u(),v("p",ct,c(a(n).name.error),1)):q("",!0)]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," SKU * ",-1)),A(e("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>a(n).sku.value=r),type:"text",class:b(["input",{"border-red-500":a(n).sku.error&&a(n).sku.touched}]),placeholder:"BUNDLE-SKU-001",onBlur:t[3]||(t[3]=r=>a(E)("sku"))},null,34),[[z,a(n).sku.value]]),a(n).sku.error&&a(n).sku.touched?(u(),v("p",pt,c(a(n).sku.error),1)):q("",!0)]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Bundle Price * ",-1)),e("div",vt,[t[16]||(t[16]=e("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500"},"$",-1)),A(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>a(n).price.value=r),type:"number",step:"0.01",min:"0",class:b(["input pl-8",{"border-red-500":a(n).price.error&&a(n).price.touched}]),placeholder:"0.00",onBlur:t[5]||(t[5]=r=>a(E)("price"))},null,34),[[z,a(n).price.value,void 0,{number:!0}]])]),a(n).price.error&&a(n).price.touched?(u(),v("p",mt,c(a(n).price.error),1)):q("",!0)]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Description ",-1)),A(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=r=>a(n).description.value=r),rows:"4",class:b(["input",{"border-red-500":a(n).description.error&&a(n).description.touched}]),placeholder:"Enter bundle description",onBlur:t[7]||(t[7]=r=>a(E)("description"))},null,34),[[z,a(n).description.value]]),a(n).description.error&&a(n).description.touched?(u(),v("p",yt,c(a(n).description.error),1)):q("",!0)]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Status * ",-1)),A(e("select",{"onUpdate:modelValue":t[8]||(t[8]=r=>a(n).status.value=r),class:b(["input",{"border-red-500":a(n).status.error&&a(n).status.touched}]),onBlur:t[9]||(t[9]=r=>a(E)("status"))},[...t[19]||(t[19]=[e("option",{value:0},"Inactive",-1),e("option",{value:1},"Active",-1),e("option",{value:2},"Archived",-1)])],34),[[de,a(n).status.value,void 0,{number:!0}]]),a(n).status.error&&a(n).status.touched?(u(),v("p",xt,c(a(n).status.error),1)):q("",!0)])]),e("div",bt,[e("div",null,[e("div",ft,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700"}," Bundle Items * ",-1)),e("button",{type:"button",onClick:t[10]||(t[10]=r=>y.value=!0),class:"btn btn-secondary btn-sm"},[h(a(he),{class:"w-4 h-4 mr-2"}),t[21]||(t[21]=N(" Add Item ",-1))])]),e("div",gt,[(u(!0),v(H,null,R(m.value,(r,C)=>{var B,O;return u(),v("div",{key:C,class:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg"},[e("div",ht,[e("div",kt,c(((B=r.sellableItem)==null?void 0:B.sku)||"Unknown Item"),1),e("div",_t,c(((O=r.sellableItem)==null?void 0:O.type)===0?"Variant":"Bundle"),1)]),e("div",$t,[t[23]||(t[23]=e("label",{class:"text-xs text-gray-500"},"Qty:",-1)),A(e("input",{"onUpdate:modelValue":ue=>r.quantity=ue,type:"number",min:"1",class:"w-16 px-2 py-1 text-sm border border-gray-300 rounded"},null,8,wt),[[z,r.quantity,void 0,{number:!0}]])]),e("button",{type:"button",onClick:ue=>se(C),class:"text-red-600 hover:text-red-800"},[h(a(fe),{class:"w-4 h-4"})],8,Ct)])}),128)),m.value.length?q("",!0):(u(),v("div",It,[h(a(ee),{class:"mx-auto h-12 w-12 text-gray-300 mb-2"}),t[24]||(t[24]=e("p",null,"No items added yet",-1)),t[25]||(t[25]=e("p",{class:"text-sm"},'Click "Add Item" to start building your bundle',-1))]))]),a(n).items.error&&a(n).items.touched?(u(),v("p",Bt,c(a(n).items.error),1)):q("",!0)])])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Additional Metadata ",-1)),e("div",At,[(u(!0),v(H,null,R(d.value,(r,C)=>(u(),v("div",{key:C,class:"flex items-center space-x-3"},[A(e("input",{"onUpdate:modelValue":B=>r.key=B,type:"text",placeholder:"Metadata key",class:"input flex-1"},null,8,St),[[z,r.key]]),A(e("input",{"onUpdate:modelValue":B=>r.value=B,type:"text",placeholder:"Metadata value",class:"input flex-1"},null,8,Vt),[[z,r.value]]),e("button",{type:"button",onClick:B=>P(C),class:"text-red-600 hover:text-red-800"},[h(a(fe),{class:"w-5 h-5"})],8,qt)]))),128)),e("button",{type:"button",onClick:ve,class:"btn btn-secondary btn-sm"},[h(a(he),{class:"w-4 h-4 mr-2"}),t[26]||(t[26]=N(" Add Metadata ",-1))])])])],32),y.value?(u(),T(ut,{key:0,onClose:t[12]||(t[12]=r=>y.value=!1),onSelect:p})):q("",!0)]),_:1},8,["title"]))}}),Et={class:"space-y-6"},Pt={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},Ft={class:"flex items-center space-x-3"},zt={class:"card p-4"},Tt={class:"flex flex-col sm:flex-row sm:items-center space-y-3 sm:space-y-0 sm:space-x-4"},Nt={class:"flex-1"},Kt={class:"relative"},Qt={class:"card"},Zt={class:"px-6 py-4 border-b border-gray-200"},Ot={class:"flex items-center justify-between"},Ht={class:"flex items-center space-x-4"},Rt={class:"text-lg font-medium text-gray-900"},Wt={class:"text-sm text-gray-500"},Gt={class:"flex items-center space-x-2"},Jt={key:0,class:"p-12 text-center"},Xt={key:1,class:"p-12 text-center"},Yt={key:2,class:"p-6"},es={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},ts={class:"aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-t-lg bg-gray-100"},ss={class:"flex items-center justify-center h-48"},ls={class:"p-4"},as={class:"flex items-start justify-between"},ns={class:"flex-1 min-w-0"},os={class:"text-sm font-medium text-gray-900 truncate"},rs={class:"text-xs text-gray-500 mt-1"},us={class:"mt-2"},ds={class:"text-xs text-gray-500"},is={key:0},cs={key:1},ps={class:"mt-2 flex items-center justify-between"},vs={class:"text-sm font-medium text-gray-900"},ms={class:"mt-3 flex items-center space-x-2"},ys=["onClick"],xs=["onClick"],bs={key:3,class:"overflow-x-auto"},fs={class:"table"},gs={class:"flex items-center space-x-1"},hs={class:"flex flex-col"},ks={class:"flex items-center justify-end space-x-1"},_s={class:"flex flex-col"},$s={class:"flex items-center"},ws={class:"flex-shrink-0 h-10 w-10"},Cs={class:"ml-4"},Is={class:"text-sm font-medium text-gray-900"},Bs={class:"text-sm text-gray-500"},As={class:"text-sm text-gray-900"},Ss={key:0},Vs={key:1},qs={class:"text-right text-sm font-medium text-gray-900"},Us={class:"text-right"},Ms={class:"flex items-center justify-end space-x-2"},Ds=["onClick"],Ls=["onClick"],js={key:4,class:"px-6 py-4 border-t border-gray-200"},Es={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0"},Ps={class:"text-sm text-gray-700"},Fs={class:"flex items-center space-x-2"},zs=["disabled"],Ts={class:"flex items-center space-x-1"},Ns=["onClick"],Ks=["disabled"],Rs=ke({__name:"CatalogView",setup(te){const L=k("grid"),f=k(""),x=k(1),U=k(12),_=k("name"),y=k("asc"),S=k(!1),F=k(!1),j=k(!1),n=k(null),V=k(null),E=Ae(),w=Me({type:"",category:"",status:""}),{data:W,isLoading:m}=ge({queryKey:["products"],queryFn:()=>we.getProducts({pageSize:1e3})}),{data:d,isLoading:p}=ge({queryKey:["bundles"],queryFn:()=>ce.getBundles({pageSize:1e3})}),se=D(()=>m.value||p.value),ve=D(()=>{var $,I;const i=((($=W.value)==null?void 0:$.data)||[]).map(g=>{var l,M;return{...g,type:"product",price:((M=(l=g.variants)==null?void 0:l[0])==null?void 0:M.price)||0}}),s=(((I=d.value)==null?void 0:I.data)||[]).map(g=>({...g,type:"bundle"}));return[...i,...s]}),P=D(()=>{let i=ve.value;if(w.type&&(i=i.filter(s=>s.type===w.type)),w.category&&(i=i.filter(s=>s.type==="product"?s.category===w.category:!0)),w.status!==""&&(i=i.filter(s=>s.status===parseInt(w.status))),f.value){const s=f.value.toLowerCase();i=i.filter($=>{var I;return $.name.toLowerCase().includes(s)||$.type==="product"&&$.slug.toLowerCase().includes(s)||$.type==="bundle"&&((I=$.sku)==null?void 0:I.toLowerCase().includes(s))})}return i.sort((s,$)=>{let I=s[_.value],g=$[_.value];return typeof I=="string"&&(I=I.toLowerCase()),typeof g=="string"&&(g=g.toLowerCase()),I<g?y.value==="asc"?-1:1:I>g?y.value==="asc"?1:-1:0}),i}),Q=D(()=>Math.ceil(P.value.length/U.value)),le=D(()=>{const i=(x.value-1)*U.value,s=i+U.value;return P.value.slice(i,s)}),me=D(()=>{const i=x.value,s=Q.value,$=2,I=[],g=[];for(let l=Math.max(2,i-$);l<=Math.min(s-1,i+$);l++)I.push(l);return i-$>2?g.push(1,"..."):g.push(1),g.push(...I),i+$<s-1?g.push("...",s):g.push(s),g.filter((l,M,K)=>K.indexOf(l)===M)}),ae=D(()=>P.value.filter(i=>i.type==="product").length),ne=D(()=>P.value.filter(i=>i.type==="bundle").length),G=()=>{x.value=1},J=i=>{_.value===i?y.value=y.value==="asc"?"desc":"asc":(_.value=i,y.value="asc"),x.value=1},Z=()=>{x.value=1},oe=()=>{n.value=null,S.value=!0},X=i=>{n.value=i,S.value=!0},re=()=>{n.value=null,F.value=!0},o=i=>{n.value=i,F.value=!0},t=i=>{V.value=i,j.value=!0},r=pe({mutationFn:i=>we.deleteProduct(i),onSuccess:()=>{E.invalidateQueries({queryKey:["products"]}),j.value=!1,V.value=null}}),C=pe({mutationFn:i=>ce.deleteBundle(i),onSuccess:()=>{E.invalidateQueries({queryKey:["bundles"]}),j.value=!1,V.value=null}}),B=async()=>{if(V.value)try{V.value.type==="product"?await r.mutateAsync(V.value.id):await C.mutateAsync(V.value.id)}catch(i){console.error("Delete error:",i)}},O=()=>{S.value=!1,n.value=null},ue=()=>{F.value=!1,n.value=null};let _e;return be(f,()=>{clearTimeout(_e),_e=setTimeout(()=>{G()},300)}),be([w],()=>{x.value=1}),(i,s)=>{var $,I,g;return u(),v("div",Et,[e("div",Pt,[s[15]||(s[15]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Product Catalog"),e("p",{class:"mt-1 text-sm text-gray-500"}," All products and bundles in your catalog ")],-1)),e("div",Ft,[e("button",{onClick:oe,class:"btn btn-secondary"},[h(a(he),{class:"w-4 h-4 mr-2"}),s[13]||(s[13]=N(" Add Product ",-1))]),e("button",{onClick:re,class:"btn btn-primary"},[h(a(ee),{class:"w-4 h-4 mr-2"}),s[14]||(s[14]=N(" Create Bundle ",-1))])])]),e("div",zt,[e("div",Tt,[e("div",Nt,[e("div",Kt,[h(a(Be),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),A(e("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>f.value=l),type:"text",placeholder:"Search products and bundles...",class:"input pl-10 w-full",onInput:G},null,544),[[z,f.value]])])]),A(e("select",{"onUpdate:modelValue":s[1]||(s[1]=l=>w.type=l),class:"input w-40",onChange:Z},[...s[16]||(s[16]=[e("option",{value:""},"All Items",-1),e("option",{value:"product"},"Products Only",-1),e("option",{value:"bundle"},"Bundles Only",-1)])],544),[[de,w.type]]),A(e("select",{"onUpdate:modelValue":s[2]||(s[2]=l=>w.category=l),class:"input w-40",onChange:Z},[...s[17]||(s[17]=[e("option",{value:""},"All Categories",-1),e("option",{value:"Electronics"},"Electronics",-1),e("option",{value:"Clothing"},"Clothing",-1),e("option",{value:"Books"},"Books",-1)])],544),[[de,w.category]]),A(e("select",{"onUpdate:modelValue":s[3]||(s[3]=l=>w.status=l),class:"input w-32",onChange:Z},[...s[18]||(s[18]=[e("option",{value:""},"All Status",-1),e("option",{value:"0"},"Active",-1),e("option",{value:"1"},"Inactive",-1)])],544),[[de,w.status]])])]),e("div",Qt,[e("div",Zt,[e("div",Ot,[e("div",Ht,[e("h3",Rt,c(P.value.length)+" items ",1),e("div",Wt,c(ae.value)+" products, "+c(ne.value)+" bundles ",1)]),e("div",Gt,[e("button",{onClick:s[4]||(s[4]=l=>L.value="grid"),class:b(["p-2 rounded-md",L.value==="grid"?"bg-primary-100 text-primary-600":"text-gray-400 hover:text-gray-600"])},[h(a(De),{class:"w-5 h-5"})],2),e("button",{onClick:s[5]||(s[5]=l=>L.value="list"),class:b(["p-2 rounded-md",L.value==="list"?"bg-primary-100 text-primary-600":"text-gray-400 hover:text-gray-600"])},[h(a(ze),{class:"w-5 h-5"})],2)])])]),se.value?(u(),v("div",Jt,[...s[19]||(s[19]=[e("div",{class:"flex items-center justify-center"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"}),e("span",{class:"ml-3 text-gray-500"},"Loading catalog...")],-1)])])):P.value.length?L.value==="grid"?(u(),v("div",Yt,[e("div",es,[(u(!0),v(H,null,R(le.value,l=>{var M,K;return u(),v("div",{key:l.id,class:"group relative bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow"},[e("div",ts,[e("div",ss,[(u(),T(xe(l.type==="bundle"?a(ee):a(Y)),{class:b(["h-12 w-12",l.type==="bundle"?"text-primary-500":"text-gray-400"])},null,8,["class"]))])]),e("div",ls,[e("div",as,[e("div",ns,[e("h3",os,c(l.name),1),e("p",rs,c(l.type==="bundle"?l.sku:l.slug),1)]),e("span",{class:b(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ml-2",l.type==="bundle"?"bg-primary-100 text-primary-800":"bg-gray-100 text-gray-800"])},c(l.type==="bundle"?"Bundle":"Product"),3)]),e("div",us,[e("p",ds,[l.type==="product"?(u(),v("span",is,c(l.category),1)):(u(),v("span",cs,c(((M=l.items)==null?void 0:M.length)||0)+" items",1))])]),e("div",ps,[e("span",vs," $"+c(((K=l.price)==null?void 0:K.toFixed(2))||"0.00"),1),e("span",{class:b(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",l.status===1?"bg-green-100 text-green-800":l.status===0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},c(l.status===1?"Active":l.status===0?"Inactive":"Archived"),3)]),e("div",ms,[e("button",{onClick:ye=>l.type==="product"?X(l):o(l),class:"flex-1 btn btn-secondary btn-sm"}," Edit ",8,ys),e("button",{onClick:ye=>t(l),class:"btn btn-secondary btn-sm text-red-600 hover:text-red-800"},[h(a(fe),{class:"w-4 h-4"})],8,xs)])])])}),128))])])):(u(),v("div",bs,[e("table",fs,[e("thead",null,[e("tr",null,[e("th",{class:"cursor-pointer hover:bg-gray-100",onClick:s[6]||(s[6]=l=>J("name"))},[e("div",gs,[s[22]||(s[22]=e("span",null,"Name",-1)),e("div",hs,[h(a(Ce),{class:b(["w-3 h-3 -mb-1",_.value==="name"&&y.value==="asc"?"text-primary-500":"text-gray-300"])},null,8,["class"]),h(a(Ie),{class:b(["w-3 h-3",_.value==="name"&&y.value==="desc"?"text-primary-500":"text-gray-300"])},null,8,["class"])])])]),s[24]||(s[24]=e("th",null,"Type",-1)),s[25]||(s[25]=e("th",null,"Category/Items",-1)),e("th",{class:"text-right cursor-pointer hover:bg-gray-100",onClick:s[7]||(s[7]=l=>J("price"))},[e("div",ks,[s[23]||(s[23]=e("span",null,"Price",-1)),e("div",_s,[h(a(Ce),{class:b(["w-3 h-3 -mb-1",_.value==="price"&&y.value==="asc"?"text-primary-500":"text-gray-300"])},null,8,["class"]),h(a(Ie),{class:b(["w-3 h-3",_.value==="price"&&y.value==="desc"?"text-primary-500":"text-gray-300"])},null,8,["class"])])])]),s[26]||(s[26]=e("th",null,"Status",-1)),s[27]||(s[27]=e("th",{class:"text-right"},"Actions",-1))])]),e("tbody",null,[(u(!0),v(H,null,R(le.value,l=>{var M,K;return u(),v("tr",{key:l.id},[e("td",null,[e("div",$s,[e("div",ws,[e("div",{class:b(["h-10 w-10 rounded-lg flex items-center justify-center",l.type==="bundle"?"bg-primary-100":"bg-gray-100"])},[(u(),T(xe(l.type==="bundle"?a(ee):a(Y)),{class:b(["h-5 w-5",l.type==="bundle"?"text-primary-600":"text-gray-500"])},null,8,["class"]))],2)]),e("div",Cs,[e("div",Is,c(l.name),1),e("div",Bs,c(l.type==="bundle"?l.sku:l.slug),1)])])]),e("td",null,[e("span",{class:b(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",l.type==="bundle"?"bg-primary-100 text-primary-800":"bg-gray-100 text-gray-800"])},c(l.type==="bundle"?"Bundle":"Product"),3)]),e("td",As,[l.type==="product"?(u(),v("span",Ss,c(l.category),1)):(u(),v("span",Vs,c(((M=l.items)==null?void 0:M.length)||0)+" items",1))]),e("td",qs," $"+c(((K=l.price)==null?void 0:K.toFixed(2))||"0.00"),1),e("td",null,[e("span",{class:b(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",l.status===1?"bg-green-100 text-green-800":l.status===0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},c(l.status===1?"Active":l.status===0?"Inactive":"Archived"),3)]),e("td",Us,[e("div",Ms,[e("button",{onClick:ye=>l.type==="product"?X(l):o(l),class:"text-primary-600 hover:text-primary-900 text-sm font-medium"}," Edit ",8,Ds),e("button",{onClick:ye=>t(l),class:"text-red-600 hover:text-red-900 text-sm font-medium"}," Delete ",8,Ls)])])])}),128))])])])):(u(),v("div",Xt,[h(a(Y),{class:"mx-auto h-12 w-12 text-gray-400"}),s[20]||(s[20]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No items found",-1)),s[21]||(s[21]=e("p",{class:"mt-1 text-sm text-gray-500"}," Try adjusting your search or filter criteria ",-1))])),Q.value>1?(u(),v("div",js,[e("div",Es,[e("div",Ps," Showing "+c((x.value-1)*U.value+1)+" to "+c(Math.min(x.value*U.value,P.value.length))+" of "+c(P.value.length)+" results ",1),e("div",Fs,[e("button",{disabled:x.value===1,onClick:s[8]||(s[8]=l=>x.value--),class:b(["btn btn-secondary btn-sm",{"opacity-50 cursor-not-allowed":x.value===1}])},[h(a(Le),{class:"w-4 h-4"}),s[28]||(s[28]=N(" Previous ",-1))],10,zs),e("div",Ts,[(u(!0),v(H,null,R(me.value,l=>(u(),v("button",{key:l,onClick:M=>x.value=l,class:b(["btn btn-sm",l===x.value?"btn-primary":"btn-secondary"])},c(l),11,Ns))),128))]),e("button",{disabled:x.value===Q.value,onClick:s[9]||(s[9]=l=>x.value++),class:b(["btn btn-secondary btn-sm",{"opacity-50 cursor-not-allowed":x.value===Q.value}])},[s[29]||(s[29]=N(" Next ",-1)),h(a(je),{class:"w-4 h-4"})],10,Ks)])])])):q("",!0)]),S.value?(u(),T(Pe,{key:0,product:n.value,onClose:s[10]||(s[10]=l=>S.value=!1),onSaved:O},null,8,["product"])):q("",!0),F.value?(u(),T(jt,{key:1,bundle:n.value,onClose:s[11]||(s[11]=l=>F.value=!1),onSaved:ue},null,8,["bundle"])):q("",!0),j.value?(u(),T(Fe,{key:2,title:`Delete ${(($=V.value)==null?void 0:$.type)==="product"?"Product":"Bundle"}`,message:`Are you sure you want to delete this ${((I=V.value)==null?void 0:I.type)==="product"?"product":"bundle"}?`,"item-name":(g=V.value)==null?void 0:g.name,warning:"This action cannot be undone.","confirm-text":"Delete","loading-text":"Deleting...",onConfirm:B,onCancel:s[12]||(s[12]=l=>j.value=!1)},null,8,["title","message","item-name"])):q("",!0)])}}});export{Rs as default};
