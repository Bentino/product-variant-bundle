import{c as _,a as e,o as U,d as ie,C as V,b as B,r as H,f as p,m as ue,u as d,i as de,t as a,w as v,n as T,g as m,y as C,F as ve,j as me,v as h,A as N,q as S}from"./index-CTkTLTUi.js";import{u as ce,a as pe,b as ye}from"./PlusIcon-BRVSf6Yh.js";import{u as R,r as be,_ as W}from"./Modal.vue_vue_type_script_setup_true_lang-Tyj6Oo8g.js";import{_ as ge}from"./DataTable.vue_vue_type_script_setup_true_lang-CMdErABm.js";function xe(D,i){return U(),_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function fe(D,i){return U(),_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const ke={class:"space-y-6"},we={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},Ce={class:"flex items-center space-x-3"},he={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},Se={class:"card p-6"},_e={class:"flex items-center"},Ue={class:"flex-shrink-0"},Me={class:"ml-5 w-0 flex-1"},qe={class:"text-lg font-medium text-gray-900"},Ve={class:"card p-6"},He={class:"flex items-center"},Re={class:"flex-shrink-0"},Ie={class:"ml-5 w-0 flex-1"},Ae={class:"text-lg font-medium text-gray-900"},$e={class:"card p-6"},Fe={class:"flex items-center"},Pe={class:"flex-shrink-0"},Be={class:"ml-5 w-0 flex-1"},Ne={class:"text-lg font-medium text-gray-900"},We={class:"card p-6"},De={class:"flex items-center"},Ke={class:"flex-shrink-0"},Qe={class:"ml-5 w-0 flex-1"},je={class:"text-lg font-medium text-gray-900"},Le={class:"text-sm font-medium text-gray-900"},Oe={class:"text-sm text-gray-500"},Te={class:"text-sm font-medium text-gray-900"},ze={class:"text-sm text-gray-600"},Ee={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},Ze={class:"flex items-center space-x-2"},Ge=["onClick"],Je=["onClick"],Xe=["value"],Ye={class:"grid grid-cols-2 gap-4"},et={class:"flex justify-end space-x-3 pt-4"},tt=["disabled"],st=["value"],ot={class:"grid grid-cols-2 gap-4"},nt={class:"flex justify-end space-x-3 pt-4"},lt=["disabled"],at=["value"],rt={class:"grid grid-cols-2 gap-4"},it=["value"],ut=["value"],dt={class:"block text-sm font-medium text-gray-700 mb-1"},vt=["max"],mt={class:"text-xs text-gray-500 mt-1"},ct={class:"flex justify-end space-x-3 pt-4"},pt=["disabled"],ft=ie({__name:"InventoryView",setup(D){const i=V({page:1,pageSize:10,search:"",warehouse:"",sortBy:"sku",sortDirection:"asc"}),z=[{key:"sku",label:"SKU",sortable:!0},{key:"onHand",label:"On Hand",sortable:!0,align:"right"},{key:"reserved",label:"Reserved",sortable:!0,align:"right"},{key:"available",label:"Available",sortable:!0,align:"right"},{key:"warehouseCode",label:"Warehouse"},{key:"lastUpdated",label:"Last Updated",sortable:!0,format:"datetime"},{key:"actions",label:"Actions",align:"right"}],{data:K,isLoading:E}=ce({queryKey:["inventory",i],queryFn:()=>S.getInventoryRecords(i),keepPreviousData:!0}),I=B(()=>{var s;return((s=K.value)==null?void 0:s.data)||[]}),Q=B(()=>{var s;return(s=K.value)==null?void 0:s.meta}),M=pe(),f=H(!1),k=H(!1),g=H(!1),l=H(null),r=V({sku:"",onHand:0,reserved:0,warehouseCode:"MAIN"}),y=V({onHand:0,reserved:0}),n=V({quantity:1,warehouseCode:"MAIN",action:"reserve"}),q=B(()=>{var w;const s=I.value,t=((w=Q.value)==null?void 0:w.total)||0,o=s.filter(c=>c.available>0).length,u=s.filter(c=>c.available>0&&c.available<10).length,b=s.filter(c=>c.available===0).length;return{totalItems:t,inStock:o,lowStock:u,outOfStock:b}}),Z=s=>{i.search=s,i.page=1},G=(s,t)=>{i.sortBy=s,i.sortDirection=t,i.page=1},J=s=>{i.page=s},X=()=>{i.page=1},A=R({mutationFn:s=>S.updateStock(s.sku,{sku:s.sku,onHand:s.onHand,reserved:s.reserved,warehouseCode:s.warehouseCode}),onSuccess:()=>{M.invalidateQueries({queryKey:["inventory"]}),f.value=!1,Y()}}),$=R({mutationFn:s=>S.updateStock(s.sku,{sku:s.sku,onHand:s.onHand,reserved:s.reserved,warehouseCode:s.warehouseCode}),onSuccess:()=>{M.invalidateQueries({queryKey:["inventory"]}),k.value=!1,l.value=null}}),F=R({mutationFn:s=>S.reserveStock(s.sku,{sku:s.sku,quantity:s.quantity,warehouseCode:s.warehouseCode}),onSuccess:()=>{M.invalidateQueries({queryKey:["inventory"]}),g.value=!1,l.value=null,j()}}),P=R({mutationFn:s=>S.releaseStock(s.sku,{sku:s.sku,quantity:s.quantity,warehouseCode:s.warehouseCode}),onSuccess:()=>{M.invalidateQueries({queryKey:["inventory"]}),g.value=!1,l.value=null,j()}}),Y=()=>{r.sku="",r.onHand=0,r.reserved=0,r.warehouseCode="MAIN"},j=()=>{n.quantity=1,n.warehouseCode="MAIN",n.action="reserve"},ee=s=>{l.value=s,y.onHand=s.onHand,y.reserved=s.reserved,k.value=!0},te=s=>{l.value=s,n.quantity=1,n.warehouseCode=s.warehouseCode,n.action="reserve",g.value=!0},se=()=>{A.mutate({sku:r.sku,onHand:r.onHand,reserved:r.reserved,warehouseCode:r.warehouseCode})},oe=()=>{l.value&&$.mutate({sku:l.value.sku,onHand:y.onHand,reserved:y.reserved,warehouseCode:l.value.warehouseCode})},ne=()=>{if(!l.value)return;const s={sku:l.value.sku,quantity:n.quantity,warehouseCode:n.warehouseCode};n.action==="reserve"?F.mutate(s):P.mutate(s)},le=()=>{n.quantity=1},ae=()=>F.isPending.value||P.isPending.value?n.action==="reserve"?"Reserving...":"Releasing...":n.action==="reserve"?"Reserve Stock":"Release Stock",re=s=>s===0?"bg-red-100 text-red-800":s<10?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800";return(s,t)=>(U(),_("div",ke,[e("div",we,[t[18]||(t[18]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Inventory"),e("p",{class:"mt-1 text-sm text-gray-500"}," Monitor stock levels and manage inventory ")],-1)),e("div",Ce,[e("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=o=>f.value=!0)},[p(d(ye),{class:"w-4 h-4 mr-2"}),t[17]||(t[17]=ue(" Update Stock ",-1))])])]),e("div",he,[e("div",Se,[e("div",_e,[e("div",Ue,[p(d(de),{class:"h-8 w-8 text-primary-600"})]),e("div",Me,[e("dl",null,[t[19]||(t[19]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Total Items ",-1)),e("dd",qe,a(q.value.totalItems),1)])])])]),e("div",Ve,[e("div",He,[e("div",Re,[p(d(xe),{class:"h-8 w-8 text-green-600"})]),e("div",Ie,[e("dl",null,[t[20]||(t[20]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," In Stock ",-1)),e("dd",Ae,a(q.value.inStock),1)])])])]),e("div",$e,[e("div",Fe,[e("div",Pe,[p(d(be),{class:"h-8 w-8 text-yellow-600"})]),e("div",Be,[e("dl",null,[t[21]||(t[21]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Low Stock ",-1)),e("dd",Ne,a(q.value.lowStock),1)])])])]),e("div",We,[e("div",De,[e("div",Ke,[p(d(fe),{class:"h-8 w-8 text-red-600"})]),e("div",Qe,[e("dl",null,[t[22]||(t[22]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Out of Stock ",-1)),e("dd",je,a(q.value.outOfStock),1)])])])])]),p(ge,{title:"Inventory Records",description:"Current stock levels across all warehouses",columns:z,data:I.value,loading:d(E),pagination:Q.value,"sort-by":i.sortBy,"sort-direction":i.sortDirection,onSearch:Z,onSort:G,onPageChange:J},{actions:v(()=>[m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>i.warehouse=o),class:"input w-40",onChange:X},[...t[23]||(t[23]=[e("option",{value:""},"All Warehouses",-1),e("option",{value:"MAIN"},"Main Warehouse",-1),e("option",{value:"WEST"},"West Coast",-1),e("option",{value:"EAST"},"East Coast",-1)])],544),[[C,i.warehouse]])]),"cell-sku":v(({value:o,item:u})=>{var b;return[e("div",null,[e("div",Le,a(o),1),e("div",Oe,a(((b=u.sellableItem)==null?void 0:b.type)===0?"Product Variant":"Bundle"),1)])]}),"cell-onHand":v(({value:o})=>[e("span",Te,a(o),1)]),"cell-reserved":v(({value:o})=>[e("span",ze,a(o),1)]),"cell-available":v(({value:o})=>[e("span",{class:T(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",re(o)])},a(o),3)]),"cell-warehouseCode":v(({value:o})=>[e("span",Ee,a(o),1)]),"cell-actions":v(({item:o})=>[e("div",Ze,[e("button",{class:"text-primary-600 hover:text-primary-900 text-sm font-medium",onClick:u=>ee(o)}," Update ",8,Ge),e("button",{class:"text-gray-600 hover:text-gray-900 text-sm font-medium",onClick:u=>te(o)}," Manage ",8,Je)])]),_:1},8,["data","loading","pagination","sort-by","sort-direction"]),p(W,{modelValue:f.value,"onUpdate:modelValue":t[7]||(t[7]=o=>f.value=o),title:"Update Stock",size:"md"},{default:v(()=>[e("form",{onSubmit:N(se,["prevent"]),class:"space-y-4"},[e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Select Item ",-1)),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.sku=o),class:"input w-full",required:""},[t[24]||(t[24]=e("option",{value:""},"Select an item...",-1)),(U(!0),_(ve,null,me(I.value,o=>(U(),_("option",{key:o.id,value:o.sku},a(o.sku)+" (Current: "+a(o.onHand)+") ",9,Xe))),128))],512),[[C,r.sku]])]),e("div",Ye,[e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," On Hand ",-1)),m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>r.onHand=o),type:"number",min:"0",class:"input w-full",required:""},null,512),[[h,r.onHand,void 0,{number:!0}]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Reserved ",-1)),m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>r.reserved=o),type:"number",min:"0",class:"input w-full",required:""},null,512),[[h,r.reserved,void 0,{number:!0}]])])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Warehouse ",-1)),m(e("select",{"onUpdate:modelValue":t[5]||(t[5]=o=>r.warehouseCode=o),class:"input w-full"},[...t[28]||(t[28]=[e("option",{value:"MAIN"},"Main Warehouse",-1)])],512),[[C,r.warehouseCode]])]),e("div",et,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[6]||(t[6]=o=>f.value=!1)}," Cancel "),e("button",{type:"submit",class:"btn btn-primary",disabled:d(A).isPending.value},a(d(A).isPending.value?"Updating...":"Update Stock"),9,tt)])],32)]),_:1},8,["modelValue"]),p(W,{modelValue:k.value,"onUpdate:modelValue":t[11]||(t[11]=o=>k.value=o),title:"Update Item Stock",size:"md"},{default:v(()=>{var o;return[e("form",{onSubmit:N(oe,["prevent"]),class:"space-y-4"},[e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," SKU ",-1)),e("input",{value:(o=l.value)==null?void 0:o.sku,class:"input w-full bg-gray-50",readonly:""},null,8,st)]),e("div",ot,[e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," On Hand ",-1)),m(e("input",{"onUpdate:modelValue":t[8]||(t[8]=u=>y.onHand=u),type:"number",min:"0",class:"input w-full",required:""},null,512),[[h,y.onHand,void 0,{number:!0}]])]),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Reserved ",-1)),m(e("input",{"onUpdate:modelValue":t[9]||(t[9]=u=>y.reserved=u),type:"number",min:"0",class:"input w-full",required:""},null,512),[[h,y.reserved,void 0,{number:!0}]])])]),e("div",nt,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[10]||(t[10]=u=>k.value=!1)}," Cancel "),e("button",{type:"submit",class:"btn btn-primary",disabled:d($).isPending.value},a(d($).isPending.value?"Updating...":"Update"),9,lt)])],32)]}),_:1},8,["modelValue"]),p(W,{modelValue:g.value,"onUpdate:modelValue":t[16]||(t[16]=o=>g.value=o),title:"Manage Stock Reservation",size:"md"},{default:v(()=>{var o,u,b,w,c,L,O;return[e("form",{onSubmit:N(ne,["prevent"]),class:"space-y-4"},[e("div",null,[t[33]||(t[33]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," SKU ",-1)),e("input",{value:(o=l.value)==null?void 0:o.sku,class:"input w-full bg-gray-50",readonly:""},null,8,at)]),e("div",rt,[e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Available Stock ",-1)),e("input",{value:(u=l.value)==null?void 0:u.available,class:"input w-full bg-gray-50",readonly:""},null,8,it)]),e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Currently Reserved ",-1)),e("input",{value:(b=l.value)==null?void 0:b.reserved,class:"input w-full bg-gray-50",readonly:""},null,8,ut)])]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Action ",-1)),m(e("select",{"onUpdate:modelValue":t[12]||(t[12]=x=>n.action=x),class:"input w-full",onChange:le},[...t[36]||(t[36]=[e("option",{value:"reserve"},"Reserve Stock",-1),e("option",{value:"release"},"Release Reserved Stock",-1)])],544),[[C,n.action]])]),e("div",null,[e("label",dt,a(n.action==="reserve"?"Quantity to Reserve":"Quantity to Release"),1),m(e("input",{"onUpdate:modelValue":t[13]||(t[13]=x=>n.quantity=x),type:"number",min:"1",max:n.action==="reserve"?((w=l.value)==null?void 0:w.available)||0:((c=l.value)==null?void 0:c.reserved)||0,class:"input w-full",required:""},null,8,vt),[[h,n.quantity,void 0,{number:!0}]]),e("p",mt,a(n.action==="reserve"?`Max: ${((L=l.value)==null?void 0:L.available)||0} (available)`:`Max: ${((O=l.value)==null?void 0:O.reserved)||0} (currently reserved)`),1)]),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Warehouse ",-1)),m(e("select",{"onUpdate:modelValue":t[14]||(t[14]=x=>n.warehouseCode=x),class:"input w-full"},[...t[38]||(t[38]=[e("option",{value:"MAIN"},"Main Warehouse",-1)])],512),[[C,n.warehouseCode]])]),e("div",ct,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[15]||(t[15]=x=>g.value=!1)}," Cancel "),e("button",{type:"submit",class:T(["btn",n.action==="reserve"?"btn-primary":"btn-warning"]),disabled:d(F).isPending.value||d(P).isPending.value},a(ae()),11,pt)])],32)]}),_:1},8,["modelValue"])]))}});export{ft as default};
